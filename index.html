<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>âœ¨ æ„¿ä½ å†¬æ—¥æ¸©æš– - å¹³å®‰å¤œå¿«ä¹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        :root { --warm-gold: #f39c12; --soft-red: #e74c3c; --bg-blue: #1a2a6c; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: linear-gradient(to bottom, #1a2a6c, #b21f1f, #fdbb2d); 
            height: 100vh; overflow: hidden; font-family: 'PingFang SC', sans-serif;
            display: flex; justify-content: center; align-items: center;
        }

        /* é›ªèŠ±èƒŒæ™¯ */
        #canvas-bg { position: fixed; top: 0; left: 0; z-index: 0; pointer-events: none; }

        /* äº¤äº’ä¸»ä½“ */
        .stage { position: relative; z-index: 10; text-align: center; }
        
        /* æµ®åŠ¨ç¤¼ç›’ */
        .gift-box {
            width: 150px; height: 150px; cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: float 3s ease-in-out infinite;
        }
        .gift-box:hover { transform: scale(1.1) rotate(5deg); }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        /* éšè—çš„è·³è½¬å¢™ */
        .portal-grid {
            display: none; grid-template-columns: repeat(2, 1fr); gap: 15px;
            margin-top: 30px; opacity: 0; transform: translateY(20px);
        }
        .portal-item {
            background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px);
            padding: 20px; border-radius: 15px; color: white; text-decoration: none;
            border: 1px solid rgba(255, 255, 255, 0.3); transition: 0.3s;
        }
        .portal-item:hover { background: rgba(255, 255, 255, 0.4); transform: scale(1.05); }

        /* æ¸©æš–æ–‡æ¡ˆ */
        .greeting { color: white; margin-top: 20px; letter-spacing: 3px; line-height: 1.6; }
        .hint { color: rgba(255,255,255,0.6); font-size: 12px; margin-top: 10px; }

        /* è§†é¢‘å¼¹çª—é€‚é… */
        .video-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 100; display: none;
            justify-content: center; align-items: center;
        }
        .video-box { width: 90%; max-width: 600px; aspect-ratio: 16/9; position: relative; }
        .close-vid { position: absolute; top: -40px; right: 0; color: white; cursor: pointer; }
    </style>
</head>
<body>

<canvas id="canvas-bg"></canvas>

<div class="stage">
    <div id="main-scene">
        <div class="gift-box" onclick="unfoldMagic()" id="gift">ğŸ</div>
        <div class="greeting">
            <h1 id="title">Hey, åœ£è¯å¿«ä¹</h1>
            <p class="hint" id="hint-text">ç‚¹å‡»ç¤¼ç›’ï¼Œå¼€å¯ä½ çš„æš–å†¬æƒŠå–œ</p>
        </div>
    </div>

    <div class="portal-grid" id="portals">
        <a href="javascript:void(0)" class="portal-item" onclick="openVideo('BV1GJ411x7h7')">
            <div style="font-size: 24px;">ğŸ“º</div>
            <div style="font-size: 14px; margin-top: 5px;">çœ‹ä¸ªè§†é¢‘</div>
        </a>
        <a href="https://www.apple.com.cn" target="_blank" class="portal-item">
            <div style="font-size: 24px;">ğŸ</div>
            <div style="font-size: 14px; margin-top: 5px;">é€ä½ è‹¹æœ</div>
        </a>
        <a href="https://music.163.com" target="_blank" class="portal-item">
            <div style="font-size: 24px;">ğŸµ</div>
            <div style="font-size: 14px; margin-top: 5px;">å¬é¦–æš–æ­Œ</div>
        </a>
        <a href="javascript:void(0)" class="portal-item" onclick="alert('æ„¿ä½ ä»Šæ™šæœ‰ä¸ªå¥½æ¢¦ï¼ğŸ’¤')">
            <div style="font-size: 24px;">âœ¨</div>
            <div style="font-size: 14px; margin-top: 5px;">ä¸“å±ç¥ç¦</div>
        </a>
    </div>
</div>

<div class="video-overlay" id="vidOverlay">
    <div class="video-box">
        <span class="close-vid" onclick="closeVideo()">âœ• å…³é—­</span>
        <iframe id="bili-player" src="" width="100%" height="100%" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>
    </div>
</div>

<audio id="bgm" loop><source src="https://m801.music.126.net/20231225/piano-warm.mp3" type="audio/mpeg"></audio>

<script>
    // 1. ä¸‰ç»´é›ªèŠ±èƒŒæ™¯
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('canvas-bg'), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);

    const snowGeo = new THREE.BufferGeometry();
    const snowCount = 1500;
    const posArr = new Float32Array(snowCount * 3);
    for(let i=0; i<snowCount*3; i++) posArr[i] = (Math.random()-0.5) * 20;
    snowGeo.setAttribute('position', new THREE.BufferAttribute(posArr, 3));
    const snowMat = new THREE.PointsMaterial({ size: 0.08, color: 0xffffff, transparent: true, opacity: 0.6 });
    const snow = new THREE.Points(snowGeo, snowMat);
    scene.add(snow);
    camera.position.z = 5;

    function animate() {
        requestAnimationFrame(animate);
        snow.rotation.y += 0.001;
        snow.position.y -= 0.01;
        if(snow.position.y < -5) snow.position.y = 5;
        renderer.render(scene, camera);
    }
    animate();

    // 2. äº¤äº’é€»è¾‘ï¼šæ‹†å¼€ç¤¼ç›’
    function unfoldMagic() {
        // æ’­æ”¾éŸ³ä¹
        document.getElementById('bgm').play().catch(() => {});
        
        // ç¤¼ç›’çˆ†ç‚¸åŠ¨ç”»
        gsap.to("#gift", { scale: 3, opacity: 0, duration: 0.5, ease: "power2.out", onComplete: () => {
            document.getElementById('gift').innerHTML = "ğŸ„";
            gsap.to("#gift", { scale: 1, opacity: 1, duration: 1, ease: "elastic.out(1, 0.3)" });
            showPortals();
        }});
        
        document.getElementById('title').innerText = "å¹³å®‰å¤œå¿«ä¹";
        document.getElementById('hint-text').innerText = "æ„¿æ¯ä¸€ä¸ªæ„¿æœ›éƒ½èƒ½æˆçœŸ";
    }

    function showPortals() {
        const grid = document.getElementById('portals');
        grid.style.display = 'grid';
        gsap.to(grid, { opacity: 1, y: 0, duration: 1, delay: 0.5 });
    }

    // 3. è§†é¢‘é€»è¾‘
    function openVideo(bvid) {
        const overlay = document.getElementById('vidOverlay');
        const player = document.getElementById('bili-player');
        player.src = `//player.bilibili.com/player.html?bvid=${bvid}&page=1&high_quality=1`;
        overlay.style.display = 'flex';
    }

    function closeVideo() {
        document.getElementById('vidOverlay').style.display = 'none';
        document.getElementById('bili-player').src = '';
    }

    window.onresize = () => {
        camera.aspect = window.innerWidth/window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    };
</script>
</body>
</html>
